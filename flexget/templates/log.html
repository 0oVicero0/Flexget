{% extends "layout.html" %}
{% block head %}
    <link rel="stylesheet" href="/static/css/ui.jqgrid.css" type="text/css" media="screen"/>
    <script type="text/javascript" src="/static/js/grid.locale-en.js"></script>
    <script type="text/javascript" src="/static/js/jquery.jqGrid.min.js"></script>
    <style type="text/css">
        .ui-jqgrid tr.jqgrow td {
            white-space: normal !important;
        }

    </style>
{% endblock %}

{% block main %}

<script type=text/javascript>
    $(function(){
        $("#logarea").jqGrid({
            url:"{{ url_for('get_logdata') }}",
            datatype: 'json',
            mtype: 'GET',
            colNames: ['Date','Level','Logger','Message'],
            colModel: [
                {name:'created', width:150, align: 'right'},
                {name:'levelno', width:65, sortable: false},
                {name:'logger', width:100, sortable: false},
                {name:'message', width:900, sortable: false}
            ],
            pager: '#pager',
            autowidth: true,
            height: 500,
            width: 700,
            scroll: 1,
            rowNum: 50,
            sortname: 'created',
            sortorder: 'desc',
            viewrecords: true,
            caption: 'Log viewer',
            jsonReader: {
                root: 'rows',
                page: 'page',
                total: 'total',
                records: 'records',
                repeatitems: false,
                id: "id"
            },
            prmNames: {
                npages: 'npages'
            }
        }).navGrid('#pager', {refresh: true, search:false, del:false, edit:false, add:false});
        //inter = setInterval('refreshGrid();', 10000);
    });
    function refreshGrid(){
         $("#logarea").trigger("reloadGrid"); // no good, brings up the loading screen
    }
</script>
<h1>FlexGet log messages</h1>

<p>
    <table id="logarea"></table>
    <div id="pager"></div>
</p>

{% endblock %}
